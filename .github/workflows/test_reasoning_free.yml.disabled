name: Test Open Reasoning (No Key)
on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  reasoning:
    runs-on: ubuntu-latest
    steps:
      - name: üß† Call public reasoning endpoint (no API key)
        run: |
          set -euo pipefail
          echo "Testing open reasoning endpoint..."

          jq -n \
            --arg prompt "Reply only with the word 'pong' if you can read this." \
            '{model:"phi3:mini", prompt:$prompt}' > req.json

          echo "Request:"
          cat req.json
          echo

          curl -s -i -X POST \
            -H "Content-Type: application/json" \
            https://api.openai-ollama.com/v1/chat/completions \
            --data @req.json -o resp.json

          echo
          echo "‚úÖ Raw response:"
          cat resp.json || true

          if grep -iq "pong" resp.json; then
            echo "‚úÖ Reasoning response OK."
          else
            echo "‚ùå Model did not return expected output."
            exit 1
          fi
