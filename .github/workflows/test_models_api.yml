name: Test GitHub Models API
on:
  workflow_dispatch:

permissions:
  contents: read
  models: read

jobs:
  hello-model:
    runs-on: ubuntu-latest
    steps:
      - name: üß† Call GitHub Models API (Hello World)
        env:
          GITHUB_TOKEN: ${{ github.token }}
        run: |
          echo "Testing GitHub Models API..."

          jq -n \
            --arg input "Hello from GitHub Actions, please reply with 'pong' if you can hear me." \
            '{
              model: "openai/gpt-4o-mini",
              input: $input
            }' > req.json

          echo "Request:"
          cat req.json
          echo

          curl -s -i -X POST \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            -H "Content-Type: application/json" \
            https://api.github.com/orgs/${{ github.repository_owner }}/models/inference \
            --data @req.json -o resp.json || {
              echo "‚ùå Request failed"
              cat resp.json
              exit 1
            }

          echo "‚úÖ Raw response:"
          cat resp.json
