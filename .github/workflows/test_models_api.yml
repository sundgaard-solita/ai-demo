name: Test Copilot Models API
on:
  workflow_dispatch:

permissions:
  contents: read
  models: read

jobs:
  hello-model:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ§  Call Copilot Models API (Hello World)
        env:
          GITHUB_TOKEN: ${{ github.token }}
        run: |
          echo "Testing Copilot Models API..."

          jq -n \
            --arg input "Hello from GitHub Actions. Please reply with the single word 'pong'." \
            '{
              model: "openai/gpt-4o-mini",
              input: $input,
              parameters: { temperature: 0.2 }
            }' > req.json

          echo "Request:"
          cat req.json
          echo

          curl -s -i -X POST \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            -H "Content-Type: application/json" \
            https://api.githubcopilot.com/models/inference \
            --data @req.json -o resp.json

          echo "âœ… Raw response:"
          cat resp.json
