name: Copilot Agent Hello World

on:
  workflow_dispatch:  # run manually for testing

permissions:
  contents: read
  issues: write

jobs:
  hello-agent:
    runs-on: ubuntu-latest
    env:
      GH_TOKEN: ${{ secrets.PAT_GITHUB }}

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install latest GitHub CLI and Copilot extension
        run: |
          echo "Installing latest GitHub CLI..."
          sudo apt-get update -qq
          sudo apt-get install -y -qq gh
          echo "Installing Copilot extension..."
          gh extension install github/gh-copilot || gh extension upgrade github/gh-copilot

      - name: Verify authentication
        run: |
          gh auth status || echo "‚ö†Ô∏è Authentication check failed"

      - name: Call Copilot Agent
        run: |
          echo "üß† Testing Copilot Agent connectivity..."
          gh copilot agent create \
            --name "Hello-Test-Agent" \
            --instructions "You are a helpful assistant. Reply with 'pong' when you receive 'ping'." \
            --input "ping" \
            --debug
